<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>十进制转R进制计算器</title>
  <script src="https://unpkg.com/@tailwindcss/browser@4"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
  <style type="text/tailwindcss">
    @theme {
      --color-primary: #3b82f6;
      --color-secondary: #10b981;
      --font-inter: 'Inter', sans-serif;
    }
    @utility fade-in {
      animation: fadeIn 0.5s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body class="min-h-screen bg-gray-50 font-inter p-4 md:p-8">
  <div class="max-w-3xl mx-auto bg-white rounded-lg shadow-md p-6 fade-in">
    <h1 class="text-2xl md:text-3xl font-bold text-primary mb-6 flex items-center">
      <i class="fas fa-calculator mr-3"></i>十进制转R进制计算器
    </h1>
    <p class="text-gray-600 mb-6">欢迎使用十进制转R进制计算器。请输入一个十进制数，我将为您展示其转换为二进制、八进制和十六进制的过程。</p>
    <div class="mb-6">
      <label for="decimalInput" class="block text-gray-700 mb-2">输入十进制数：</label>
      <input type="number" id="decimalInput" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" placeholder="请输入非负整数，例如29">
    </div>
    <button id="calculateBtn" class="bg-primary hover:bg-primary/90 text-white px-6 py-2 rounded-lg transition duration-300 flex items-center">
      <i class="fas fa-cog mr-2"></i>计算转换
    </button>

    <div id="results" class="mt-8 space-y-8 hidden">
      <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
        <h2 class="text-xl font-semibold text-secondary mb-4 flex items-center">
          <i class="fas fa-binary mr-2"></i>二进制转换过程
        </h2>
        <div id="binaryResult" class="space-y-2"></div>
      </div>

      <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
        <h2 class="text-xl font-semibold text-secondary mb-4 flex items-center">
          <i class="fas fa-octagon mr-2"></i>八进制转换过程
        </h2>
        <div id="octalResult" class="space-y-2"></div>
      </div>

      <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
        <h2 class="text-xl font-semibold text-secondary mb-4 flex items-center">
          <i class="fas fa-hexagon mr-2"></i>十六进制转换过程
        </h2>
        <div id="hexResult" class="space-y-2"></div>
      </div>
    </div>
  </div>

  <script>
    document.getElementById('calculateBtn').addEventListener('click', function() {
      const decimal = parseInt(document.getElementById('decimalInput').value);
      if (isNaN(decimal) || decimal < 0) {
        alert('请输入有效的非负十进制整数');
        return;
      }

      const binary = convertBase(decimal, 2);
      const octal = convertBase(decimal, 8);
      const hex = convertBase(decimal, 16);

      displayResult('binaryResult', binary, 2);
      displayResult('octalResult', octal, 8);
      displayResult('hexResult', hex, 16);

      document.getElementById('results').classList.remove('hidden');
    });

    function convertBase(decimal, base) {
      if (decimal === 0) return { steps: [{ quotient: 0, remainder: 0 }], result: '0' };
      
      const steps = [];
      let num = decimal;
      
      while (num > 0) {
        const remainder = num % base;
        const quotient = Math.floor(num / base);
        steps.push({ quotient, remainder, original: num }); // 添加original记录当前被除的数
        num = quotient;
      }
      
      let result = '';
      for (let i = steps.length - 1; i >= 0; i--) {
        let rem = steps[i].remainder;
        if (base === 16 && rem >= 10) {
          rem = String.fromCharCode(rem + 55); // 转换为A-F
        } else {
          rem = rem.toString();
        }
        result += rem;
      }
      
      return { steps, result };
    }

    function displayResult(elementId, conversion, base) {
      const container = document.getElementById(elementId);
      container.innerHTML = '';

      // 步骤标题行
      const headerRow = document.createElement('div');
      headerRow.className = 'grid grid-cols-3 font-semibold text-gray-700 pb-2 border-b';
      headerRow.innerHTML = `
        <div>步骤说明</div>
        <div>商</div>
        <div>余数</div>
      `;
      container.appendChild(headerRow);

      // 遍历每一步转换过程
      conversion.steps.forEach((step, index) => {
        const row = document.createElement('div');
        row.className = 'grid grid-cols-3 py-2 border-b border-gray-200';
        
        // 步骤说明调整为"原始数 ÷ 基数"的格式
        let description = `${step.original} ÷ ${base}`;
        if (index === conversion.steps.length - 1) {
          description += `<br>（商为 ${step.quotient}，小于基数 ${base}<br>，停止计算）`;
        }

        let remainderDisplay = step.remainder;
        if (base === 16 && step.remainder >= 10) {
          remainderDisplay = String.fromCharCode(step.remainder + 55);
        }

        row.innerHTML = `
          <div>${description}</div>
          <div>${step.quotient}</div>
          <div class="text-red-500 font-medium">${remainderDisplay}</div> <!-- 余数标红并加粗 -->
        `;
        container.appendChild(row);
      });

      // 显示最终结果，添加逆序取余说明
      const resultRow = document.createElement('div');
      resultRow.className = 'mt-4 text-lg font-semibold text-primary';
      resultRow.innerHTML = `
        最终结果：${conversion.result}（将所有红色余数按逆序排列得到）
      `;
      container.appendChild(resultRow);
    }
  </script>
</body>
</html>